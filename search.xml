<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>借助百度云接口完成文本情感分析(通用版)</title>
    <url>/%E7%94%A8%E7%99%BE%E5%BA%A6%E6%8E%A5%E5%8F%A3%E5%AE%8C%E6%88%90%E6%96%87%E6%9C%AC%E6%83%85%E6%84%9F%E8%AF%86%E5%88%AB(%E9%80%9A%E7%94%A8%E7%89%88).html</url>
    <content><![CDATA[<p>借助百度云接口完成文本情感分析(通用版)，如果没有购买一秒可以处理两条数据，可以用在小项目上，如果是批量，那么建议使用模型或者购买，价钱不详。</p>
<a id="more"></a>

<h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><h2 id="1注册百度云"><a href="#1注册百度云" class="headerlink" title="1注册百度云"></a>1注册百度云</h2><p>我这里就到控制台了</p>
<p><a href="https://cloud.baidu.com/?from=console" target="_blank" rel="external nofollow noopener noreferrer">https://cloud.baidu.com/?from=console</a></p>
<p><img src="https://img-blog.csdnimg.cn/20200629112827986.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="2进入控制台创建应用"><a href="#2进入控制台创建应用" class="headerlink" title="2进入控制台创建应用"></a>2进入控制台创建应用</h2><p><a href="https://console.bce.baidu.com/ai/#/ai/nlp/overview/index" target="_blank" rel="external nofollow noopener noreferrer">https://console.bce.baidu.com/ai/#/ai/nlp/overview/index</a><br><strong>1进入nlp相关</strong><br><img src="https://img-blog.csdnimg.cn/20200629113003656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>2创建自己的应用</strong><br><img src="https://img-blog.csdnimg.cn/202006291137425.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt></p>
<p><strong>3得到AK和SK</strong></p>
<p>AK是api key，SK是secret key。</p>
<p>##3获取Access Token</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">def <span class="title">getToken</span><span class="params">()</span>:</span></span><br><span class="line"><span class="function">    # client_id 为官网获取的AK， client_secret 为官网获取的SK</span></span><br><span class="line"><span class="function">    host </span>= <span class="string">'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id='</span> + App_Key + <span class="string">'&amp;client_secret='</span> + Secret_Key</span><br><span class="line">    response = requests.get(host)</span><br><span class="line"></span><br><span class="line">    if response.status_code == 200: #响应成功</span><br><span class="line">        info = json.loads(response.text)  # 将字符串转成字典</span><br><span class="line">        access_token = info['access_token']  # 解析数据到access_token</span><br><span class="line">        <span class="keyword">return</span> access_token</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span></span><br></pre></td></tr></table></figure>





<h2 id="4情感分析"><a href="#4情感分析" class="headerlink" title="4情感分析"></a>4情感分析</h2><p>首先看接口返回信息</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"text"</span>:<span class="string">"苹果是一家伟大的公司"</span>,</span><br><span class="line">    <span class="string">"items"</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"sentiment"</span>:<span class="number">2</span>,    <span class="comment">//表示情感极性分类结果</span></span><br><span class="line">            <span class="string">"confidence"</span>:<span class="number">0.40</span>, <span class="comment">//表示分类的置信度</span></span><br><span class="line">            <span class="string">"positive_prob"</span>:<span class="number">0.73</span>, <span class="comment">//表示属于积极类别的概率</span></span><br><span class="line">            <span class="string">"negative_prob"</span>:<span class="number">0.27</span>  <span class="comment">//表示属于消极类别的概率</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">def <span class="title">getEmotion</span><span class="params">(inputText, access_token)</span>:</span></span><br><span class="line"><span class="function">    url </span>= <span class="string">'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify?access_token='</span> + access_token</span><br><span class="line">    header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line">    res = requests.post(url=url, data=json.dumps(body), headers=header, verify=False)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span> sentiment == <span class="number">2</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:正向'</span>)</span><br><span class="line">            elif sentiment == <span class="number">1</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:中性'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:负向'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5实现"><a href="#5实现" class="headerlink" title="5实现"></a>5实现</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">App_Key = <span class="string">'自己申请的AK'</span></span><br><span class="line">Secret_Key = <span class="string">'自己申请的SK'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 情感分析</span><br><span class="line"><span class="function">def <span class="title">getEmotion</span><span class="params">(inputText, access_token)</span>:</span></span><br><span class="line"><span class="function">    url </span>= <span class="string">'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify?access_token='</span> + access_token</span><br><span class="line">    header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line">    res = requests.post(url=url, data=json.dumps(body), headers=header, verify=False)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info) #打印接口返回信息，如果报错方便查看，也可以忽略报错继续执行</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span> sentiment == <span class="number">2</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:正向'</span>)</span><br><span class="line">            elif sentiment == <span class="number">1</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:中性'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:负向'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 获取token</span><br><span class="line"><span class="function">def <span class="title">getToken</span><span class="params">()</span>:</span></span><br><span class="line"><span class="function">    # client_id 为官网获取的AK， client_secret 为官网获取的SK</span></span><br><span class="line"><span class="function">    host </span>= <span class="string">'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id='</span> + App_Key + <span class="string">'&amp;client_secret='</span> + Secret_Key</span><br><span class="line">    response = requests.get(host)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(response.text)  # 将字符串转成字典</span><br><span class="line">        access_token = info['access_token']  # 解析数据到access_token</span><br><span class="line">        <span class="keyword">return</span> access_token</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 主函数</span><br><span class="line"><span class="function">def <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    inputText ="今天天气真好" #进行识别的语句，根据需求可以改成读取文件或者输入</span><br><span class="line">    accessToken = getToken()</span><br><span class="line">    getEmotion(inputText, accessToken)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">'log_id'</span>: <span class="number">2064186719012084925</span>, <span class="string">'text'</span>: <span class="string">'今天天气真好'</span>, <span class="string">'items'</span>: [&#123;<span class="string">'positive_prob'</span>: <span class="number">0.997986</span>, <span class="string">'confidence'</span>: <span class="number">0.995524</span>, <span class="string">'negative_prob'</span>: <span class="number">0.00201416</span>, <span class="string">'sentiment'</span>: <span class="number">2</span>&#125;]&#125;</span><br><span class="line">今天天气真好  情感分析结果是:正向</span><br></pre></td></tr></table></figure>


<h2 id="6注意点"><a href="#6注意点" class="headerlink" title="6注意点"></a>6注意点</h2><p>1个人账户的情感识别的QPS是2，所以多条文本报错一般是因为数据太多</p>
<p>2文本不能过长，不要超过2048</p>
]]></content>
      <categories>
        <category>百度云</category>
      </categories>
      <tags>
        <tag>百度云接口</tag>
        <tag>情感分析</tag>
      </tags>
  </entry>
  <entry>
    <title>百度云api调用时出现“Max retries exceeded with url”的解决</title>
    <url>/%E7%99%BE%E5%BA%A6%E4%BA%91api%E8%B0%83%E7%94%A8%E6%97%B6%E5%87%BA%E7%8E%B0Max%20retries%20exceeded%20with%20url%E7%9A%84%E8%A7%A3%E5%86%B3.html</url>
    <content><![CDATA[<p>这个是因为qps限制问题我们需要加sleep，例子：</p>
<a id="more"></a>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">for</span> i in <span class="title">range</span><span class="params">(<span class="number">0</span>,len(df)</span>):</span></span><br><span class="line"><span class="function">       <span class="title">print</span><span class="params">(i)</span></span></span><br><span class="line"><span class="function">       time.<span class="title">sleep</span><span class="params">(<span class="number">1</span>)</span> #这里</span></span><br><span class="line"><span class="function">       inputText</span>=df.at[i,<span class="string">"微博正文"</span>]</span><br><span class="line">       print(inputText)</span><br><span class="line">       <span class="keyword">if</span>(len(inputText)&lt;<span class="number">2048</span>):</span><br><span class="line">           accessToken = getToken()</span><br><span class="line">           everyday_list.append(last_getProEmotion(inputText,accessToken))</span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           data = cut_text(inputText, 1500)  # 如果文章字节长度大于1500，则切分</span><br><span class="line">           accessToken = getToken()</span><br><span class="line">           everyday_list.append(last_getProEmotion(data , accessToken))</span><br><span class="line"> print(everyday_list)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>百度云</category>
      </categories>
      <tags>
        <tag>百度云接口</tag>
        <tag>情感分析</tag>
      </tags>
  </entry>
  <entry>
    <title>百度云情感分析定制版</title>
    <url>/%E7%99%BE%E5%BA%A6%E4%BA%91%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E5%AE%9A%E5%88%B6%E7%89%88.html</url>
    <content><![CDATA[<p>借助百度云接口完成文本情感分析(通用版)，如果没有购买一秒可以处理两条数据，可以用在小项目上，如果是批量，那么建议使用模型或者购买，价钱不详。</p>
<a id="more"></a>

<h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><h2 id="1先看通用版有个大体印象"><a href="#1先看通用版有个大体印象" class="headerlink" title="1先看通用版有个大体印象"></a>1先看通用版有个大体印象</h2><p>链接<a href="https://blog.csdn.net/qq_41318400/article/details/107016732" target="_blank" rel="external nofollow noopener noreferrer">添加链接描述</a><br>链接详情：<a href="https://blog.csdn.net/qq_41318400/article/details/107016732" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_41318400/article/details/107016732</a></p>
<h2 id="2进入应用管理创建模型"><a href="#2进入应用管理创建模型" class="headerlink" title="2进入应用管理创建模型"></a>2进入应用管理创建模型</h2><p><img src="https://img-blog.csdnimg.cn/20200629120753213.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>地址：<br><a href="https://console.bce.baidu.com/ai/#/ai/nlp/sentiment/dict/list" target="_blank" rel="external nofollow noopener noreferrer">https://console.bce.baidu.com/ai/#/ai/nlp/sentiment/dict/list</a></p>
<h2 id="3创建模型"><a href="#3创建模型" class="headerlink" title="3创建模型"></a>3创建模型</h2><p><img src="https://img-blog.csdnimg.cn/20200629120851530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>写好名称和场景描述，之后把正负样本放进去，最后训练，训练好之后确认模型。<br>例子：<br><img src="https://img-blog.csdnimg.cn/20200629121100106.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这个我放入了微博的数据大概各是5w之后效果到大概98%，没截图现在不能截了</p>
<h2 id="4情感分析"><a href="#4情感分析" class="headerlink" title="4情感分析"></a>4情感分析</h2><p>Access Token是不变的，post的url要改变。<br>接口返回信息是不变的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"text"</span>:<span class="string">"苹果是一家伟大的公司"</span>,</span><br><span class="line">    <span class="string">"items"</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"sentiment"</span>:<span class="number">2</span>,    <span class="comment">//表示情感极性分类结果</span></span><br><span class="line">            <span class="string">"confidence"</span>:<span class="number">0.40</span>, <span class="comment">//表示分类的置信度</span></span><br><span class="line">            <span class="string">"positive_prob"</span>:<span class="number">0.73</span>, <span class="comment">//表示属于积极类别的概率</span></span><br><span class="line">            <span class="string">"negative_prob"</span>:<span class="number">0.27</span>  <span class="comment">//表示属于消极类别的概率</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">def <span class="title">getEmotion</span><span class="params">(inputText, access_token)</span>:</span></span><br><span class="line">    url = 'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify_custom?access_token=' + access_token #就是这里</span><br><span class="line">    header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line">    res = requests.post(url=url, data=json.dumps(body), headers=header, verify=False)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span> sentiment == <span class="number">2</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:正向'</span>)</span><br><span class="line">            elif sentiment == <span class="number">1</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:中性'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:负向'</span>)</span><br></pre></td></tr></table></figure>
<p> ！！！一定要让模型生效再使用，不然会报错的</p>
<h2 id="5实现"><a href="#5实现" class="headerlink" title="5实现"></a>5实现</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">App_Key = <span class="string">'自己申请的AK'</span></span><br><span class="line">Secret_Key = <span class="string">'自己申请的SK'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 情感分析</span><br><span class="line"><span class="function">def <span class="title">getEmotion</span><span class="params">(inputText, access_token)</span>:</span></span><br><span class="line"><span class="function">    url </span>= <span class="string">'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify_custom?access_token='</span> + access_token</span><br><span class="line">    header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">    requests.packages.urllib3.disable_warnings()</span><br><span class="line">    res = requests.post(url=url, data=json.dumps(body), headers=header, verify=False)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info) #打印接口返回信息，如果报错方便查看，也可以忽略报错继续执行</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span> sentiment == <span class="number">2</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:正向'</span>)</span><br><span class="line">            elif sentiment == <span class="number">1</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:中性'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(inputText + <span class="string">'  情感分析结果是:负向'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 获取token</span><br><span class="line"><span class="function">def <span class="title">getToken</span><span class="params">()</span>:</span></span><br><span class="line"><span class="function">    # client_id 为官网获取的AK， client_secret 为官网获取的SK</span></span><br><span class="line"><span class="function">    host </span>= <span class="string">'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id='</span> + App_Key + <span class="string">'&amp;client_secret='</span> + Secret_Key</span><br><span class="line">    response = requests.get(host)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(response.text)  # 将字符串转成字典</span><br><span class="line">        access_token = info['access_token']  # 解析数据到access_token</span><br><span class="line">        <span class="keyword">return</span> access_token</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 主函数</span><br><span class="line"><span class="function">def <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    inputText ="哎哟，不错哟" #进行识别的语句，根据需求可以改成读取文件或者输入</span><br><span class="line">    accessToken = getToken()</span><br><span class="line">    getEmotion(inputText, accessToken)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">'log_id'</span>: <span class="number">8877028948092554077</span>, <span class="string">'text'</span>: <span class="string">'哎哟，不错哟'</span>, <span class="string">'items'</span>: [&#123;<span class="string">'positive_prob'</span>: <span class="number">0.954273</span>, <span class="string">'confidence'</span>: <span class="number">0.898385</span>, <span class="string">'negative_prob'</span>: <span class="number">0.0457269</span>, <span class="string">'sentiment'</span>: <span class="number">2</span>&#125;]&#125;</span><br><span class="line">哎哟，不错哟  情感分析结果是:正向</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>百度云</category>
      </categories>
      <tags>
        <tag>百度云接口</tag>
        <tag>情感分析</tag>
      </tags>
  </entry>
  <entry>
    <title>解决百度云情感分析乱码问题</title>
    <url>/%E8%A7%A3%E5%86%B3%E7%99%BE%E5%BA%A6%E4%BA%91%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98.html</url>
    <content><![CDATA[<p>在读取文本数据时碰到了xxx is not JSON serializable，主要是因为json.dump()或者json.dumps()无法序列化.<br>原始函数</p>
<a id="more"></a>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function">def <span class="title">last_getProEmotion</span><span class="params">(inputText, access_token)</span>: #情感分析的函数</span></span><br><span class="line"><span class="function">      url </span>= <span class="string">'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify_custom?access_token='</span> + access_token</span><br><span class="line">      header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">      body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">      requests.packages.urllib3.disable_warnings()</span><br><span class="line">      res = requests.post(url=url, data=json.dumps(body), headers=header, verify=False)</span><br><span class="line">      time.sleep(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span>(sentiment==<span class="number">0</span>):</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span>  sentiment</span><br></pre></td></tr></table></figure>

<p>解决方法：<br>新建一个MyEncoder类来继承json.JSONEncoder，重写json.JSONEncoder中的方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy as np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MyEncoder(json.JSONEncoder):</span><br><span class="line">    <span class="function">def <span class="title">default</span><span class="params">(self, obj)</span>:</span></span><br><span class="line"><span class="function">        <span class="keyword">if</span> <span class="title">isinstance</span><span class="params">(obj, np.integer)</span>:</span></span><br><span class="line"><span class="function">            return <span class="title">int</span><span class="params">(obj)</span></span></span><br><span class="line"><span class="function">        elif <span class="title">isinstance</span><span class="params">(obj, np.floating)</span>:</span></span><br><span class="line"><span class="function">            return <span class="title">float</span><span class="params">(obj)</span></span></span><br><span class="line"><span class="function">        elif <span class="title">isinstance</span><span class="params">(obj, np.ndarray)</span>:</span></span><br><span class="line"><span class="function">            return obj.<span class="title">tolist</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        <span class="keyword">else</span>:</span></span><br><span class="line"><span class="function">            return <span class="title">super</span><span class="params">(NpEncoder, self)</span>.<span class="title">default</span><span class="params">(obj)</span></span></span><br></pre></td></tr></table></figure>

<p>然后引用之后修改json.dumps()的参数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function">def <span class="title">last_getProEmotion</span><span class="params">(inputText, access_token)</span>: #情感分析的函数</span></span><br><span class="line"><span class="function">    url </span>= <span class="string">'https://aip.baidubce.com/rpc/2.0/nlp/v1/sentiment_classify_custom?access_token='</span> + access_token</span><br><span class="line">      header = &#123;<span class="string">'Content-Type	'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">      body = &#123;<span class="string">'text'</span>: inputText&#125;</span><br><span class="line">      requests.packages.urllib3.disable_warnings()</span><br><span class="line">      res = requests.post(url=url, data=json.dumps(body,cls=MyEncoder), headers=header, verify=False)#就是这个位置</span><br><span class="line">      time.sleep(<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">        info = json.loads(res.text)</span><br><span class="line">        print(info)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'items'</span> <span class="function">in info and <span class="title">len</span><span class="params">(info[<span class="string">'items'</span>])</span> &gt; 0:</span></span><br><span class="line"><span class="function">            sentiment </span>= info[<span class="string">'items'</span>][<span class="number">0</span>][<span class="string">'sentiment'</span>]</span><br><span class="line">            <span class="keyword">if</span>(sentiment==<span class="number">0</span>):</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span>  sentiment</span><br></pre></td></tr></table></figure>
<p>参考<br><a href="https://blog.csdn.net/qq_28935065/article/details/90265719?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=data=json.dumps" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_28935065/article/details/90265719?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=data=json.dumps</a>(body,%20cls=NpEn&amp;utm_medium=distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-1-90265719</p>
]]></content>
      <categories>
        <category>百度云</category>
      </categories>
      <tags>
        <tag>百度云接口</tag>
        <tag>情感分析</tag>
      </tags>
  </entry>
  <entry>
    <title>借助bmob实现简单的登陆注册</title>
    <url>/%E5%80%9F%E5%8A%A9bmob%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E7%99%BB%E9%99%86%E6%B3%A8%E5%86%8C.html</url>
    <content><![CDATA[<p>借助bmob后端云实现简单的登录注册，我这个是安卓项目，支持微信，安卓等，个人不需要收费，商用和企业需要，课设挺香的。</p>
<a id="more"></a>

<p><img src="http://i2.tiimg.com/723232/e5e5488cb6a240f4.gif" alt="动态展示"></p>
<p><img src="https://img-blog.csdnimg.cn/20190410220636600.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>欢迎下载<br><a href="https://github.com/kurumi2501314/Bmobdemo/blob/master/demo.apk" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/Bmobdemo/blob/master/demo.apk</a></p>
<h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><p>详细可以去我的github<br><a href="https://github.com/kurumi2501314/Bmobdemo" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/Bmobdemo</a><br>只是将官方文档稍作了修改，详细更改还是去官方文档。</p>
<h2 id="1注册bmob"><a href="#1注册bmob" class="headerlink" title="1注册bmob"></a>1注册bmob</h2><p>去bmob官网注册，地址<br><a href="https://www.bmob.cn/" target="_blank" rel="external nofollow noopener noreferrer">https://www.bmob.cn/</a><br>然后在我的控制台创建应用，之后<br><img src="https://img-blog.csdnimg.cn/20190410210713150.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_7,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我的这里是demo，点击进入你新进的那个应用，例如我进入demo<br><img src="https://img-blog.csdnimg.cn/20190410210915862.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>设置里的第一个Application ID就是之后需要的。数据里是你建的表，默认有一个user表，如果需要扩充，如性别，简介，兴趣爱好这些需要一个子类继承bmobuser类进行扩展。</p>
<h2 id="2配置Bomb相关"><a href="#2配置Bomb相关" class="headerlink" title="2配置Bomb相关"></a>2配置Bomb相关</h2><p><strong>1配置SDK</strong><br><img src="https://img-blog.csdnimg.cn/20190410211630887.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>源于官网文档</p>
<p><strong>2配置权限和ContentProvider</strong></p>
<p>打开AndroidManifest.xml，添加如下权限：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--允许联网 --&gt; </span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.INTERNET"</span> /&gt; </span><br><span class="line">&lt;!--获取GSM（<span class="number">2</span>g）、WCDMA（联通<span class="number">3</span>g）等网络状态的信息  --&gt; </span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt; </span><br><span class="line">&lt;!--获取wifi网络状态的信息 --&gt; </span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span> /&gt; </span><br><span class="line">&lt;!--保持CPU 运转，屏幕和键盘灯有可能是关闭的,用于文件上传和下载 --&gt;</span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.WAKE_LOCK"</span> /&gt; </span><br><span class="line">&lt;!--获取sd卡写的权限，用于文件上传和下载--&gt;</span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;</span><br><span class="line">&lt;!--允许读取手机状态 用于创建BmobInstallation--&gt; </span><br><span class="line">&lt;uses-permission android:name=<span class="string">"android.permission.READ_PHONE_STATE"</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>然后配置ContentProvider</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;application&gt;</span><br><span class="line">···</span><br><span class="line">&lt;provider</span><br><span class="line">    android:name=<span class="string">"cn.bmob.v3.util.BmobContentProvider"</span></span><br><span class="line">    android:authorities=<span class="string">"你的应用包名.BmobContentProvider"</span>&gt;</span><br><span class="line">&lt;/provider&gt;</span><br><span class="line">···</span><br><span class="line">&lt;/application&gt;</span><br></pre></td></tr></table></figure>

<p>这两个都是官网文档的，这里直接引用。</p>
<p><strong>3初始化bmob</strong></p>
<p>在活动的oncreate方法里初始化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_main);</span><br><span class="line">       Bmob.initialize(<span class="keyword">this</span>,<span class="string">"这里填写你自己的id，就是第一步注册后看到的那个"</span>);</span><br><span class="line">     </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


<h2 id="3扩展自己的用户列表"><a href="#3扩展自己的用户列表" class="headerlink" title="3扩展自己的用户列表"></a>3扩展自己的用户列表</h2><p>BmobUser默认里没有昵称，性别这些，所以如果用的话需要继承然后扩展，新建Myuser类继承BmobUser。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.bmobdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bmob.v3.BmobUser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyUser</span>  <span class="keyword">extends</span> <span class="title">BmobUser</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//补充其他属性</span></span><br><span class="line">    <span class="keyword">private</span>  String fakename;<span class="comment">//昵称</span></span><br><span class="line">    <span class="keyword">private</span>  String introd;<span class="comment">//简介</span></span><br><span class="line">    <span class="keyword">private</span>  String sex; <span class="comment">//性别</span></span><br><span class="line">    <span class="keyword">private</span>  String interesting; <span class="comment">//兴趣爱好</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFakename</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  fakename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">setFakename</span><span class="params">(String fakename)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fakename=fakename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIntrod</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  introd;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">setIntrod</span><span class="params">(String introd)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.introd=introd;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">getSex</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">setSex</span><span class="params">(String sex)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex=sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">getInteresting</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> interesting;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">setInteresting</span><span class="params">(String interesting)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.interesting=interesting;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<h2 id="4实现注册"><a href="#4实现注册" class="headerlink" title="4实现注册"></a>4实现注册</h2><p>默认在登陆页，当点击注册按钮后进入注册界面，填写相关信息。<br><img src="https://img-blog.csdnimg.cn/20190410212842106.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxMzE4NDAw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>布局就是线性布局然后向里面填充，然后密码栏选择了password属性的Edittext所以是不可见的，布局不再赘述，详细可以去我git看全部，这里主要是活动里。<br>活动也很简单，先初始化布局控件，然后判断点击，再添加点击事件。关于注册方法bmob给封装了，在官方文档是这样的：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">signUp</span><span class="params">(<span class="keyword">final</span> View view)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setUsername(<span class="string">""</span> + System.currentTimeMillis());</span><br><span class="line">    user.setPassword(<span class="string">""</span> + System.currentTimeMillis());</span><br><span class="line">    user.setAge(<span class="number">18</span>);</span><br><span class="line">    user.setGender(<span class="number">0</span>);</span><br><span class="line">    user.signUp(<span class="keyword">new</span> SaveListener&lt;User&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">done</span><span class="params">(User user, BmobException e)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (e == <span class="keyword">null</span>) &#123;</span><br><span class="line">                Snackbar.make(view, <span class="string">"注册成功"</span>, Snackbar.LENGTH_LONG).show();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Snackbar.make(view, <span class="string">"尚未失败："</span> + e.getMessage(), Snackbar.LENGTH_LONG).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里稍作修改，关键部分如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_signup);</span><br><span class="line">       Bmob.initialize(<span class="keyword">this</span>,<span class="string">"我的应用id"</span>);</span><br><span class="line">       initview(); <span class="comment">//初始化布局</span></span><br><span class="line">       setListen();<span class="comment">//设置监听</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setListen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       re_sgin_btn.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initview</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//省略</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(v.getId()==R.id.sgin_up_btn)</span><br><span class="line">          &#123;</span><br><span class="line">              signup();</span><br><span class="line">          &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">signup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">final</span>  MyUser myUser=<span class="keyword">new</span> MyUser();</span><br><span class="line">       myUser.setUsername(re_username.getText().toString().trim());</span><br><span class="line">       myUser.setPassword(re_possword.getText().toString().trim());</span><br><span class="line">       myUser.setFakename(re_fake.getText().toString().trim());</span><br><span class="line">       myUser.setSex(re_sex.getText().toString().trim());</span><br><span class="line">       myUser.setIntrod(re_intro.getText().toString().trim());</span><br><span class="line">       myUser.setInteresting(re_inter.getText().toString().trim());</span><br><span class="line">       myUser.signUp(<span class="keyword">new</span> SaveListener&lt;MyUser&gt;() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">done</span><span class="params">(MyUser user, BmobException e)</span></span></span><br><span class="line"><span class="function">           </span>&#123;</span><br><span class="line">               <span class="keyword">if</span> (e==<span class="keyword">null</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   Toast.makeText(getApplicationContext(),<span class="string">"注册成功"</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">                   Intent intent=<span class="keyword">new</span> Intent(SignupActivity.<span class="keyword">this</span>,MainActivity<span class="class">.<span class="keyword">class</span>)</span>;    <span class="comment">//注册成功就去登陆页，其实finish（）也行。</span></span><br><span class="line">                   startActivity(intent);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="5实现登陆"><a href="#5实现登陆" class="headerlink" title="5实现登陆"></a>5实现登陆</h2><p>布局就是开始效果图那样，不再赘述<br>登陆活动的关键部分如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (v.getId())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span>  R.id.signin:</span><br><span class="line">                 login();</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span>  R.id.signup:</span><br><span class="line">            Intent intent1=<span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>,SignupActivity<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            startActivity(intent1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span>  MyUser user=<span class="keyword">new</span> MyUser();</span><br><span class="line">    <span class="keyword">final</span>  String username=username_signin.getText().toString().trim();</span><br><span class="line">    <span class="keyword">final</span>  String password=userpassword_signin.getText().toString().trim();</span><br><span class="line">    user.setUsername(username);</span><br><span class="line">    user.setPassword(password);</span><br><span class="line">    user.login(<span class="keyword">new</span> SaveListener&lt;MyUser&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span>  <span class="title">done</span><span class="params">(MyUser myUser, BmobException e)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(e==<span class="keyword">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                MyUser user=MyUser.getCurrentUser(MyUser<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">                Intent intent =<span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>,nextActivity<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">                startActivity(intent);</span><br><span class="line">                Toast.makeText(getApplicationContext(),<span class="string">"登陆成功"</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Toast.makeText(getApplicationContext(),<span class="string">""</span>+e.getMessage(),Toast.LENGTH_LONG).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p>详细可以去我github去看完整<br><a href="https://github.com/kurumi2501314/Bmobdemo" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/Bmobdemo</a></p>
<p>欢迎下载<br><a href="https://github.com/kurumi2501314/Bmobdemo/blob/master/demo.apk" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/Bmobdemo/blob/master/demo.apk</a></p>
]]></content>
      <categories>
        <category>后端云</category>
      </categories>
      <tags>
        <tag>bmob</tag>
        <tag>登录注册</tag>
      </tags>
  </entry>
  <entry>
    <title>Android Studio引用github第三方库完成美观的侧滑菜单</title>
    <url>/Android-Studio%E5%BC%95%E7%94%A8github%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AE%8C%E6%88%90%E7%BE%8E%E8%A7%82%E7%9A%84%E4%BE%A7%E6%BB%91%E8%8F%9C%E5%8D%95.html</url>
    <content><![CDATA[<p>借助github的第三方库实现美观侧滑菜单。</p>
<a id="more"></a>
<p>预览图<br><img src="http://i1.fuimg.com/723232/cf76124142bccb31.gif" alt="在这里插入图片描述"></p>
<p>欢迎下载<br><a href="https://github.com/kurumi2501314/demo/blob/master/demo.apk" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/demo/blob/master/demo.apk</a></p>
<h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><p>引用的地址为<br>  <a href="https://github.com/mzule/FantasySlide" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/mzule/FantasySlide</a><br>原文有使用介绍，这里将步骤详</p>
<h2 id="1添加依赖"><a href="#1添加依赖" class="headerlink" title="1添加依赖"></a>1添加依赖</h2><p>在app下的build.gradle的依赖位置进行添加，因为更新，所以请把  <strong>compile</strong> 改为<br><strong>implementation</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在dependencies的范围里添加</span></span><br><span class="line"> implementation <span class="string">'com.github.mzule.fantasyslide:library:1.0.5'</span></span><br></pre></td></tr></table></figure>



<h2 id="2进行布局"><a href="#2进行布局" class="headerlink" title="2进行布局"></a>2进行布局</h2><p>如同原博主所言，可以把这个当做抽屉布局就可以了，演示就直接用他的例子了。图片偷懒也使用博主的例子了。侵删。<br>篇幅有限，这里贴关键部分。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">    android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;com.github.mzule.fantasyslide.FantasyDrawerLayout                                        </span><br><span class="line">        xmlns:app=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span><br><span class="line">        android:id=<span class="string">"@+id/drawerLayout"</span></span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">        &lt;com.github.mzule.fantasyslide.SideBar</span><br><span class="line">            android:id=<span class="string">"@+id/leftSideBar"</span></span><br><span class="line">            android:layout_width=<span class="string">"200dp"</span></span><br><span class="line">            android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_gravity=<span class="string">"start"</span></span><br><span class="line">            android:background=<span class="string">"@color/colorPrimary"</span></span><br><span class="line">            android:gravity=<span class="string">"center_vertical"</span></span><br><span class="line">            app:maxTranslationX=<span class="string">"66dp"</span>&gt;</span><br><span class="line"></span><br><span class="line">            &lt;LinearLayout</span><br><span class="line">                android:id=<span class="string">"@+id/userInfo"</span></span><br><span class="line">                android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">                android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">                android:layout_marginBottom=<span class="string">"30dp"</span></span><br><span class="line">                android:gravity=<span class="string">"center_horizontal"</span></span><br><span class="line">                android:onClick=<span class="string">"onClick"</span></span><br><span class="line">                android:orientation=<span class="string">"vertical"</span>&gt;</span><br><span class="line"></span><br><span class="line">                &lt;com.example.demo.widget.CircleimageView</span><br><span class="line">                    android:layout_width=<span class="string">"110dp"</span></span><br><span class="line">                    android:layout_height=<span class="string">"110dp"</span></span><br><span class="line">                    android:layout_margin=<span class="string">"10dp"</span></span><br><span class="line">                    android:src=<span class="string">"@drawable/me"</span></span><br><span class="line">                    app:civ_border_color=<span class="string">"@color/menu_text_color"</span></span><br><span class="line">                    app:civ_border_width=<span class="string">"2dp"</span> /&gt;</span><br><span class="line"></span><br><span class="line">                &lt;TextView</span><br><span class="line">                    android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">                    android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">                    android:text=<span class="string">"昵称"</span></span><br><span class="line">                    android:textColor=<span class="string">"@color/menu_text_color"</span></span><br><span class="line">                    android:textSize=<span class="string">"18sp"</span> /&gt;</span><br><span class="line">            &lt;<span class="regexp">/LinearLayout&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">            &lt;TextView</span></span><br><span class="line"><span class="regexp">                style="@style/</span>MenuText1<span class="string">"</span></span><br><span class="line"><span class="string">                android:drawableLeft="</span>@drawable/circle<span class="string">"</span></span><br><span class="line"><span class="string">                android:text="</span>朋友圈<span class="string">" /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;TextView</span></span><br><span class="line"><span class="string">                style="</span>@style/MenuText1<span class="string">"</span></span><br><span class="line"><span class="string">                android:drawableLeft="</span>@drawable/wallet<span class="string">"</span></span><br><span class="line"><span class="string">                android:text="</span>钱包<span class="string">" /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">        &lt;/com.github.mzule.fantasyslide.SideBar&gt;</span></span><br><span class="line"><span class="string">        &lt;com.github.mzule.fantasyslide.SideBar</span></span><br><span class="line"><span class="string">            android:id="</span>@+id/rightSideBar<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_width="</span><span class="number">133</span>dp<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_height="</span>match_parent<span class="string">"</span></span><br><span class="line"><span class="string">            android:layout_gravity="</span>end<span class="string">"</span></span><br><span class="line"><span class="string">            android:background="</span>@drawable/bg_right_bar<span class="string">"</span></span><br><span class="line"><span class="string">            android:gravity="</span>center_vertical|right<span class="string">"</span></span><br><span class="line"><span class="string">            app:maxTranslationX="</span><span class="number">-33</span>dp<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;TextView</span></span><br><span class="line"><span class="string">                style="</span>@style/MenuText1<span class="string">"</span></span><br><span class="line"><span class="string">                android:text="</span>星期一<span class="string">" /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;TextView</span></span><br><span class="line"><span class="string">                style="</span>@style/MenuText1<span class="string">"</span></span><br><span class="line"><span class="string">                android:text="</span>星期二<span class="string">" /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;TextView</span></span><br><span class="line"><span class="string">                style="</span>@style/MenuText1<span class="string">"</span></span><br><span class="line"><span class="string">                android:text="</span>星期三<span class="string">" /&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">           </span></span><br><span class="line"><span class="string">        &lt;/com.github.mzule.fantasyslide.SideBar&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;/com.github.mzule.fantasyslide.FantasyDrawerLayout&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;TextView</span></span><br><span class="line"><span class="string">        android:id="</span>@+id/tipView<span class="string">"</span></span><br><span class="line"><span class="string">        android:layout_width="</span><span class="number">160</span>dp<span class="string">"</span></span><br><span class="line"><span class="string">        android:layout_height="</span>wrap_content<span class="string">"</span></span><br><span class="line"><span class="string">        android:layout_alignParentRight="</span><span class="literal">true</span><span class="string">"</span></span><br><span class="line"><span class="string">        android:background="</span>@color/colorPrimary<span class="string">"</span></span><br><span class="line"><span class="string">        android:gravity="</span>center<span class="string">"</span></span><br><span class="line"><span class="string">        android:padding="</span><span class="number">20</span>dp<span class="string">"</span></span><br><span class="line"><span class="string">        android:textColor="</span>@color/colorAccent<span class="string">"</span></span><br><span class="line"><span class="string">        android:textSize="</span><span class="number">16</span>sp<span class="string">"</span></span><br><span class="line"><span class="string">        android:visibility="</span>invisible<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">&lt;/RelativeLayout&gt;</span></span><br></pre></td></tr></table></figure>
<p>重点是在侧滑菜单的部分，其中 <strong>start</strong> 是说这个是左滑的，右滑是<strong>end</strong>，这个请注意。<br>另外关于头像部分，原博主是调用了一个github上的一个圆形视图库，链接<br><a href="https://github.com/hdodenhof/CircleImageView" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/hdodenhof/CircleImageView</a><br>这里是继承后改了些，详情可以去看原博主或者我Git里widget部分。<br>另外drawble后缀是说图片的比例尺寸。</p>
<h2 id="3设置Listener来监听侧滑菜单"><a href="#3设置Listener来监听侧滑菜单" class="headerlink" title="3设置Listener来监听侧滑菜单"></a>3设置Listener来监听侧滑菜单</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">private <span class="keyword">void</span> setListener() &#123;</span><br><span class="line">    final TextView tipView = (TextView) findViewById(R.id.tipView);</span><br><span class="line">    SideBar leftSideBar = (SideBar) findViewById(R.id.leftSideBar);</span><br><span class="line">    leftSideBar.setFantasyListener(<span class="keyword">new</span> SimpleFantasyListener() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public boolean onHover(@Nullable View view, int index) &#123;</span><br><span class="line">            tipView.setVisibility(View.VISIBLE);</span><br><span class="line">            <span class="keyword">if</span> (view <span class="keyword">instanceof</span> TextView) &#123;</span><br><span class="line">                tipView.setText(<span class="built_in">String</span>.format(<span class="string">"%s at %d"</span>, ((TextView) view).getText().toString(), index));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (view != <span class="literal">null</span> &amp;&amp; view.getId() == R.id.userInfo) &#123;</span><br><span class="line">                tipView.setText(<span class="built_in">String</span>.format(<span class="string">"个人中心 at %d"</span>, index));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tipView.setText(<span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        @Override</span><br><span class="line">        public boolean onSelect(View view, int index) &#123;</span><br><span class="line">            tipView.setVisibility(View.INVISIBLE);</span><br><span class="line">            Toast.makeText(MainActivity.this, <span class="built_in">String</span>.format(<span class="string">"%d selected"</span>, index), Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public <span class="keyword">void</span> onCancel() &#123;</span><br><span class="line">            tipView.setVisibility(View.INVISIBLE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里只是确认是不是点击，因为考虑到还有后续，所以将每个选项的点击后的反应放在第二个activity，这里只用变色就可以了。<br>关于第二个活动：<br>原博主第二个界面是调用了另一个github的库，地址如下<br><a href="https://github.com/ikew0ng/SwipeBackLayout" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/ikew0ng/SwipeBackLayout</a><br>所以总共需要添加三个</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation fileTree(dir: <span class="string">'libs'</span>, <span class="attr">include</span>: [<span class="string">'*.jar'</span>])</span><br><span class="line">    implementation <span class="string">'com.android.support:appcompat-v7:28.0.0'</span></span><br><span class="line">    implementation <span class="string">'com.android.support.constraint:constraint-layout:1.1.3'</span></span><br><span class="line">    testImplementation <span class="string">'junit:junit:4.12'</span></span><br><span class="line">    androidTestImplementation <span class="string">'com.android.support.test:runner:1.0.2'</span></span><br><span class="line">    androidTestImplementation <span class="string">'com.android.support.test.espresso:espresso-core:3.0.2'</span></span><br><span class="line">    implementation <span class="string">'com.github.mzule.fantasyslide:library:1.0.5'</span></span><br><span class="line">    implementation <span class="string">'de.hdodenhof:circleimageview:3.0.0'</span></span><br><span class="line">    implementation <span class="string">'me.imid.swipebacklayout.lib:library:1.1.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后可以在这个位置通过对标题的确认来添加事件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_seconde);</span><br><span class="line">    swipeBackActivityHelper &#x3D; new SwipeBackActivityHelper(this);</span><br><span class="line">    swipeBackActivityHelper.onActivityCreate();</span><br><span class="line">    getSupportActionBar().setDisplayHomeAsUpEnabled(true);</span><br><span class="line">    setTitle(getIntent().getStringExtra(&quot;title&quot;));</span><br><span class="line">   &#x2F;&#x2F; if(getTitle().equals(&quot;xxx&quot;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  注释的部分就是了，在那里通过比较不同的字符串标题来添加事件。</p>
<h2 id="4Transformer的改变"><a href="#4Transformer的改变" class="headerlink" title="4Transformer的改变"></a>4Transformer的改变</h2><p>原博主的实例特效是平移的，我这里将其改变为旋转，是在右边将这个特效做了实现。<br>效果如下：</p>
<p><img src="https://img-blog.csdnimg.cn/20190405191402852.gif" alt="在这里插入图片描述"></p>
<p>详细可以去我github去看完整<br><a href="https://github.com/kurumi2501314/demo" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/demo</a><br>欢迎下载<br><a href="https://github.com/kurumi2501314/demo/blob/master/demo.apk" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/kurumi2501314/demo/blob/master/demo.apk</a></p>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>github</tag>
      </tags>
  </entry>
</search>
